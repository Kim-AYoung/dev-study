# 프로세스

## 프로세스
- 프로세스 : 보조 기억 장치에 있던 데이터 덩어리를 실행하게 되면 프로세스가 된다
- 즉, 실행하는 프로그램 

## 프로세스 종류
- 포그라운드 프로세스 : 사용자가 볼 수 있음, 메모장 등
- 백그라운드 프로세스 : 사용자가 볼 수 없음
    - 사용자와 상호작용이 가능한 프로세스
    - 사용자와 상호작용이 불가능하고 정해진 일만 하는 프로세스 = 데몬(daemon) = 서비스(service)
- 프로세스는 실행되는 프로그램이기 때문에 cpu를 필수로 필요로 하는데 cpu는 한정적이기 때문에 운영체제가 프로세스 제어 블록을 해야 함
    - 즉, 빠르게 번갈아 수행되는 프로세스들을 관리해야 함

## PCB

- PCB : 프로세스의 온갖 정보가 저장되는 자료구조
    - 태그
    - 프로세스 생성시 커널영역에 PCB가 자동으로 생성, 종료시 폐기
    - 프로세스 관련 정보를 저장함
        - 프로세스 ID (PID)
        - 레지스터 값
        - 프로세스 상태
        - CPU 스케줄링 정보
        - 메모리 정보
        - 사용한 파일과 입출력 장치 정보

## 문맥교환

- 문맥교환
    - cpu가 하나의 프로세스(A)를 실행한 다음 타임 인터럽트가 발생했을 때 어떻게 다른 프로세스(B)로 바뀌게 되는지
        - A 프로세스의 중간정보(문맥, context)를 백업
        - B 프로세스의 문맥 복구

## 메모리영역

- 프로세스의 메모리 영역
    - 즉, 사용자 여역에서 어떻게 프로세스를 저장하는가?
    - 정적할당영역 (크기 고정)
        - 코드(텍스트)영역
            - 데이터가 아닌 cpu가 실행할 명령어(기계어, 코드)를 저장
            - 명령어는 바뀌지 않기 때문에 write는 안되고 only-read
        - 데이터 영역
            - 전역변수
            - 잠깐 사용하는 게 아닌 프로세스가 실행되는 동안 유지할 데이터,
            - 프로그램 전체에서 접근 가능한 데이터 저장
    - 동적할당영역 (가변 크기)
        - 스택 영역
            - 일시적 데이터 저장
            - 매개변수, 지역변수
            - 큰 주소에서 낮은 주소로 메모리 할
        - 힙 영역
            - 프로그래머(사용자)가 할당함
            - 메모리 반환을 해줘야 함
                - 최신 언어들은 가비지컬렉션을 자동으로 해주지만, c언어 같은 경우 직접 메모리반환을 해야 함
                - 안 할 경우, 메모리 누수
            - 낮은 주소에서 큰 주소로 할당함
                - 스택과 반대인 이유
                - 서로 주소를 겹치지 않게 하기 위해서
    - 기타영역
        - bs 영역 등

## 프로세스 상태

- 프로세스의 상태
    - 생성 상태
        - 막 메모리에 적재되어 PCB를 할당 받은 상태
        - 준비가 완료(cpu를 할당 받기만 하면 실행가능)가 되면 준비상
    - 준비 상태
        - cpu에서 실행되길 기다리는 상태
        - 디스패치 : 준비상태 → 실행상태
    - 실행 상태
        - cpu를 할당받아 실행중
        - 할당된 시간 모두 사용시(타이머 인터럽트 발생)시 준비상태로
        - 실행 도중 입출력 장치를 사용하면 입출력 작업이 끝날 때까지 대기 상태로
            - 왜냐면, cpu에서 실행되는 시간보다 입출력 장치를 사용하는 게 시간이 더 오래 걸리기 때문
    - 대기 상태
        - 프로세스가 실행도중 입출력 장치를 사용하는 경우
        - 입출력 작업이 끝나면 (입출력 완료 인터럽트를 받으면) 준비상태로
    - 종료 상태
        - 프로세스 종료
        - PCB, 프로세스의 메모리 영역 정리

## 계층 구조

- 프로세스 계층 구조
    - 프로세스 실행 도중 (시스템 호출 시 ) 다른 프로세스 생성
    - 데몬 프로세스는 최초의 프로세스의 자식

## 생성 기법

- 프로세스 생성 기법
    - fork 시스템 호출
        - 부모 프로세스가 자신의 복사본으로 자식 프로세스 생성
            - 부모 프로세스의 자원 상속
            - PID 값, 메모리 주소값은 다르다.
    - exec 시스템 호출
        - 자식 프로세스가 자신의 메모리 공간을 다른 프로그램으로 교체
            - 안 바꾸는 경우도 있는데 그 때에는 같은 프로세스를 병행적으로 사용하는 거임
            - 코드/데이터 영역은 실행할 프로그램 내용으로 바뀌고 나머지 영역은 초기화
